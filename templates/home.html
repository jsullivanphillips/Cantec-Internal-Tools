<!-- templates/home.html -->
{% extends "base.html" %}

{% block title %}Home - Scheduling App{% endblock %}

{% block extra_head %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}">
{% endblock %}

{% block content %}
<div class="container py-4 home-wrap">

  <!-- Header -->
  <div class="home-header mb-3">
    <div>
      <h1 class="home-title mb-1">Home</h1>
      <div class="home-subtitle text-muted">
        Quick briefing & fast actions
      </div>
    </div>

    <div class="home-updated text-muted small">
      <i class="bi bi-clock me-1"></i>
      <span id="home-last-updated">—</span>
    </div>
  </div>

  <!-- ROW 1: KPIs -->
  <div class="row g-3 mb-3">
    <!-- Jobs to be processed KPI -->
    <div class="col-12 col-sm-6 col-lg-3">
      <a class="home-kpi card kpi-card h-100" href="{{ url_for('processing_attack.processing_attack') }}">
        <div class="card-body kpi-body" data-kpi="to-be-processed">
          <!-- Skeleton (shown while loading) -->
          <div class="kpi-skeleton" id="kpi-to-be-processed-skel" aria-hidden="true">
            <div class="skel-line skel-w-70 mb-2"></div>
            <div class="skel-line skel-w-35 skel-h-lg mb-2"></div>
            <div class="skel-line skel-w-55"></div>
          </div>

          <!-- Real content (hidden until loaded) -->
          <div class="kpi-real d-none" id="kpi-to-be-processed-real">
            <div class="kpi-top">
              <span class="kpi-label">Jobs to be processed</span>
              <span class="kpi-pill" id="kpi-pill-to-be-processed">—</span>
            </div>
            <div class="kpi-value">
              <span id="kpi-to-be-processed">—</span><span class="kpi-suffix"></span>
            </div>
            <div class="kpi-foot text-muted">Click to open Processing Attack</div>
          </div>
        </div>
      </a>
    </div>
    <!-- End of jobs to be processed KPI -->

    <!-- Jobs to be invoiced KPI -->
    <div class="col-12 col-sm-6 col-lg-3">
      <a class="home-kpi card kpi-card h-100" href="{{ url_for('processing_attack.processing_attack') }}">
        <div class="card-body kpi-body" data-kpi="invoiced">
          <!-- Skeleton (shown while loading) -->
          <div class="kpi-skeleton" id="kpi-invoiced-skel" aria-hidden="true">
            <div class="skel-line skel-w-70 mb-2"></div>
            <div class="skel-line skel-w-35 skel-h-lg mb-2"></div>
            <div class="skel-line skel-w-55"></div>
          </div>

          <!-- Real content (hidden until loaded) -->
          <div class="kpi-real d-none" id="kpi-invoiced-real">
            <div class="kpi-top">
              <span class="kpi-label">Jobs to be invoiced</span>
              <span class="kpi-pill" id="kpi-pill-invoiced">—</span>
            </div>
            <div class="kpi-value">
              <span id="kpi-invoiced">—</span><span class="kpi-suffix"></span>
            </div>
            <div class="kpi-foot text-muted">Click to open Processing Attack</div>
          </div>
        </div>
      </a>
    </div>
    <!-- End of jobs to be invoiced KPI -->

    <!-- Forward schedule coverage KPI -->
    <div class="col-12 col-sm-6 col-lg-3">
      <a class="home-kpi card kpi-card h-100" href="{{ url_for('scheduling_attack.scheduling_attack') }}">
        <div class="card-body kpi-body" data-kpi="forward-coverage">
          <!-- Skeleton (shown while loading) -->
          <div class="kpi-skeleton" id="kpi-forward-skel" aria-hidden="true">
            <div class="skel-line skel-w-70 mb-2"></div>
            <div class="skel-line skel-w-35 skel-h-lg mb-2"></div>
            <div class="skel-line skel-w-55"></div>
          </div>

          <!-- Real content (hidden until loaded) -->
          <div class="kpi-real d-none" id="kpi-forward-real">
            <div class="kpi-top">
              <span class="kpi-label">Confirmed in next two weeks</span>
              <span class="kpi-pill" id="kpi-pill-forward">—</span>
            </div>
            <div class="kpi-value">
              <span id="kpi-forward-coverage">—</span><span class="kpi-suffix">%</span>
            </div>
            <div class="kpi-foot text-muted">Click to open Scheduling Attack</div>
          </div>
        </div>
      </a>
    </div>
    <!-- End of forward schedule coverage KPI -->


    <!-- Jobs completed today KPI -->
    <div class="col-12 col-sm-6 col-lg-3">
      <a class="home-kpi card kpi-card h-100" href="{{ url_for('processing_attack.processing_attack') }}">
        <div class="card-body kpi-body" data-kpi="completed">
          <!-- Skeleton (shown while loading) -->
          <div class="kpi-skeleton" id="kpi-completed-skel" aria-hidden="true">
            <div class="skel-line skel-w-70 mb-2"></div>
            <div class="skel-line skel-w-35 skel-h-lg mb-2"></div>
            <div class="skel-line skel-w-55"></div>
          </div>

          <!-- Real content (hidden until loaded) -->
          <div class="kpi-real d-none" id="kpi-completed-real">
            <div class="kpi-top">
              <span class="kpi-label">Jobs processed today</span>
              <span class="kpi-pill" id="kpi-pill-completed">—</span>
            </div>
            <div class="kpi-value">
              <span id="kpi-completed">—</span><span class="kpi-suffix"></span>
            </div>
            <div class="kpi-foot text-muted">Today's completions</div>
          </div>
        </div>
      </a>
    </div>
    <!-- End of jobs completed today -->

  <!-- ROW 2: Needs Attention -->
  <div class="card mb-3 home-section-card">
    <div class="card-header d-flex align-items-center justify-content-between">
      <div class="d-flex align-items-center gap-2">
        <i class="bi bi-exclamation-circle"></i>
        <strong>Needs attention</strong>
      </div>
      <button class="btn btn-sm btn-outline-secondary" id="home-refresh" type="button">
        <i class="bi bi-arrow-clockwise me-1"></i> Refresh
      </button>
    </div>

    <div class="card-body">
      <div class="row g-3">
        <!-- Left: alerts list -->
        <div class="col-12 col-lg-7">
          <div class="home-attn-list" id="home-attn-list">

            <!-- Skeleton (shown while loading) -->
            <div id="home-attn-skel" aria-hidden="true">
              <div class="home-attn-item">
                <div class="skel-line skel-w-70 mb-2"></div>
                <div class="skel-line skel-w-55"></div>
              </div>
              <div class="home-attn-item">
                <div class="skel-line skel-w-65 mb-2"></div>
                <div class="skel-line skel-w-50"></div>
              </div>
              <div class="home-attn-item">
                <div class="skel-line skel-w-60 mb-2"></div>
                <div class="skel-line skel-w-45"></div>
              </div>
            </div>

            <!-- Empty state (shown if no items) -->
            <div class="home-empty text-muted" id="home-attn-empty" style="display:none;">
              No items right now.
            </div>

          </div>
        </div>


        <!-- Right: quick links to action queues -->
        <div class="col-12 col-lg-5">
          <div class="home-attn-actions">
            <a class="btn btn-outline-primary w-100 mb-2" href="{{ url_for('processing_attack.processing_attack') }}">
              <i class="bi bi-clipboard-check me-2"></i> Open Processing queues
            </a>
            <a class="btn btn-outline-primary w-100 mb-2" href="{{ url_for('scheduling_attack.scheduling_attack') }}">
              <i class="bi bi-calendar3 me-2"></i> Open Scheduling queues
            </a>
            <a class="btn btn-outline-primary w-100" href="{{ url_for('keys.keys_home') }}">
              <i class="bi bi-key me-2"></i> View signed-out keys
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ROW 3: Quick Actions -->
  <div class="card home-section-card">
    <div class="card-header d-flex align-items-center gap-2">
      <i class="bi bi-lightning-charge"></i>
      <strong>Quick actions</strong>
    </div>

    <div class="card-body">
      <div class="row g-2">
        <div class="col-12 col-md-6 col-lg-3">
          <a class="btn btn-primary w-100" href="{{ url_for('scheduling.find_schedule') }}">
            <i class="bi bi-calendar2-check me-2"></i> Scheduling Assistant
          </a>
        </div>

        <div class="col-12 col-md-6 col-lg-3">
          <a class="btn btn-primary w-100" href="{{ url_for('processing_attack.processing_attack') }}">
            <i class="bi bi-speedometer2 me-2"></i> Processing Attack
          </a>
        </div>

        <div class="col-12 col-md-6 col-lg-3">
          <a class="btn btn-primary w-100" href="{{ url_for('scheduling_attack.scheduling_attack') }}">
            <i class="bi bi-graph-up-arrow me-2"></i> Scheduling Attack
          </a>
        </div>

        <div class="col-12 col-md-6 col-lg-3">
          <a class="btn btn-primary w-100" href="{{ url_for('deficiency_tracker.deficiency_tracker') }}">
            <i class="bi bi-exclamation-triangle me-2"></i> Deficiency Tracker
          </a>
        </div>

        <div class="col-12 col-md-6 col-lg-3">
          <a class="btn btn-outline-secondary w-100" href="{{ url_for('pink_folder.pink_folder') }}">
            <i class="bi bi-folder2-open me-2"></i> Pink Folder
          </a>
        </div>

        <div class="col-12 col-md-6 col-lg-3">
          <a class="btn btn-outline-secondary w-100" href="{{ url_for('limbo_job_tracker.limbo_job_tracker') }}">
            <i class="bi bi-hourglass-split me-2"></i> Limbo Jobs
          </a>
        </div>

        <div class="col-12 col-md-6 col-lg-3">
          <a class="btn btn-outline-secondary w-100" href="{{ url_for('monthly_specialist.monthly_specialists') }}">
            <i class="bi bi-people me-2"></i> Monthly Specialists
          </a>
        </div>

        <div class="col-12 col-md-6 col-lg-3">
          <a class="btn btn-outline-secondary w-100" href="{{ url_for('performance_summary.performance_summary') }}">
            <i class="bi bi-pie-chart me-2"></i> Performance Summary
          </a>
        </div>
      </div>
    </div>
  </div>

</div>
{% endblock %}

{% block extra_scripts %}
  <script src="{{ url_for('static', filename='js/home.js') }}"></script>
{% endblock %}
